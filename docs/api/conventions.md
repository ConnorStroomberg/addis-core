---
layout: default
title: Dataset conventions
---

Fills in specific conventions of how Trialverse datasets subsist on the versioning mechanism defined previously.

Dataset meta-data
-----------------

Dataset meta-data is stored in the default graph of the dataset in the versioning store.

 - Controlled by Trialverse: dataset URI, ...
 - Controlled by user: title, description, ...
 - Both: graph `dcterms:subject`

It is presented to the user through the default graph of the Trialverse dataset.
This default graph, however, is enriched by additonal meta-data, such as a VoID description as described in the [main specification](index.html).

TODO: define a SPARQL pattern for which triples are allowed to be modified by user queries.
TODO: define whether a non-enriched version is available.

Dataset and graph IDs
---------------------

Dataset and graph IDs may be generated by the client.
They may only contain lowercase ASCII characters, digits, and dashes ('-').
Creating a dataset can be done through a `POST` to its intended new location.
For this to succeed, the new location must match `/users/:user-id/datasets/:dataset-id`, where `:user-id` is the current user (or the user that authorized API access in case of API key authentication), and `:dataset-id` matches the allowed ID pattern.
The former results in a `403 Forbidden` response, and the latter in a `400 Bad Request` response.

TODO: where do we track which versioning dataset is which Trialverse dataset?

A graph can be created in a similar way to datasets (see the [main specification](index.html) for the subject specification mechanism), and the same ID pattern applies.
When creating a new graph, or when the `X-Trialverse-Subject` header is present on a `POST` or `PUT` request to a graph URI, the resulting transaction on the versioning store affects both the default graph and the graph in question.
Therefore, the request is translated to a SPARQL query as described in the SPARQL graph store specification, with an additional query to update the `dcterms:subject` in the default graph.

Versions
--------

As versions have a known URL pattern in the versioning store, the `:version-id` is taken from that URI and used as the `:version-id` fragment described in the [main specification](index.html).
Note that the `/users/:user-id/datasets/:dataset-id/graphs/:graph-id/versions` route does not list revisions of the graph, but rather the graph as it existed in different versions of the dataset.
The Memento timemaps are based directly on the linear history defined by the `es:previous` predicate in each dataset, both for the dataset and for the graphs contained in it (i.e. graphs change only when the dataset changes).

Creator identification & provenance
-----------------------------------

The versioning store expects a single creator URI.
However, these URIs may potentially represent more complex provenance information, for example that the request was made by a computational agent acting on behalf of a user as authenticated through an API key.
Therefore, a convention is needed on how URIs are generated in these scenarios, and where their descriptions are stored.

TODO: Users versus API keys versus groups.

TODO: [W3C PROV](http://www.w3.org/TR/2013/NOTE-prov-primer-20130430/).

 - Describing histories in W3C PROV
 - Describing relationships among agents in W3C PROV
