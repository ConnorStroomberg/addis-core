<form novalidate>
  <div class="row">
    <div class="large-9 columns">
      <h3>Add a new {{settings.itemName}}</h3>
    </div>
  </div>
  <div class="row">
    <div class="large-9 columns">
      <label>Name
        <input autofocus type="text" ng-model="item.label">
      </label>
    </div>
  </div>
  <div class="row">
    <div class="large-9 columns">
      <label>Measurement type</label>
      <input ng-model="item.measurementType" type="radio" name="measurementType" ng-change="resetResultProperties()"
        value="ontology:dichotomous" id="rateOption">
      <label for="rateOption">count</label>
      <input ng-model="item.measurementType" type="radio" name="measurementType" ng-change="resetResultProperties()"
        value="ontology:continuous" id="continuousOption">
      <label for="continuousOption">continuous</label>
      <input ng-model="item.measurementType" type="radio" name="measurementType" ng-change="resetResultProperties()"
        value="ontology:categorical" id="categoricalOption">
      <label for="categoricalOption">categorical</label>
      <input ng-model="item.measurementType" type="radio" name="measurementType" ng-change="resetResultProperties()"
        value="ontology:survival" id="survivalOption">
      <label for="survivalOption">survival</label>
    </div>
  </div>

  <div class="row" ng-if="item.measurementType === 'ontology:categorical'">
    <div class="large-9 columns">
      <label>Categories</label>
      <ul class="no-bullet" ng-if="item.categoryList.length">
        <li ng-repeat="category in item.categoryList"><a><i class="fa fa-trash-o" style="color: red;" ng-click="deleteCategory(category)"></i></a> {{category}}</li>
      </ul>
      <span ng-if="!item.categoryList.length">(no categories defined yet)</span>
      <input ng-model="newCategory.categoryLabel" ng-keypress="addCategoryEnterKey($event, newCategory)">
      <button class="small" ng-disabled="cannotAddCategory(newCategory)" type="button"
        ng-click="addCategory(newCategory)">Add category</button>
      <span class="alert" ng-if="isDuplicateCategory(newCategory)">Duplicate category name</span>
    </div>
  </div>

  <div class="row" ng-if="item.measurementType !== 'ontology:categorical'">
    <div class="large-9 columns">
      <label>Included result properties:</label>
      <span ng-show="!changeResultProperties" ng-repeat="resultProperty in item.selectedResultProperties">
        <strong>{{resultProperty.label}}{{$last ? '' : ', '}}</strong>
      </span>
      <result-properties ng-show="changeResultProperties" variable="item"></result-properties>
      <br>
      <button class="small" type="button" ng-click="changeResultProperties = !changeResultProperties">{{changeResultProperties ? 'Hide result properties' : 'Change'}}</button>
    </div>
  </div>

  <div class="row" ng-if="showTimeScaleInput">
    <div class="large-9 columns">
    <label>
      Time scale
      <select ng-options="timeScaleOption.duration as timeScaleOption.label for timeScaleOption in timeScaleOptions" ng-model="item.timeScale"></select>
    </label>
    </div>
  </div>

  <div class="row">
    <div class="large-9 columns">
      <subset-select target="item.measuredAtMoments" source="measurementMoments" equals="measurementMomentEquals"></subset-select>
    </div>
  </div>

  <div class="row">
    <div class="large-9 columns">
      <button class="success" type="button"  ng-click="addItem()" ng-disabled="!item.label || !item.measurementType">Add</button>
    </div>
  </div>
  <a class="close-reveal-modal" ng-click="cancel()">&#215;</a>
</form>
